# 구글 스프레드시트 유틸리티 도구모음 사용 가이드

## 📋 목차
- [설치 방법](#설치-방법)
- [기능 목록](#기능-목록)
- [사용 방법](#사용-방법)
- [주의사항](#주의사항)

## 🚀 설치 방법

### 1단계: Google 스프레드시트 열기
- 사용하고자 하는 Google 스프레드시트를 엽니다.

### 2단계: Apps Script 편집기 열기
1. 메뉴에서 **확장 프로그램** > **Apps Script** 클릭
2. 새 Apps Script 프로젝트가 열립니다.

### 3단계: 코드 붙여넣기
1. 기본으로 있는 `Code.gs` 파일의 내용을 모두 삭제
2. `SpreadsheetUtilities.gs` 파일의 내용을 복사하여 붙여넣기
3. 프로젝트 이름을 "스프레드시트 유틸리티"로 변경 (선택사항)

### 4단계: 저장 및 권한 승인
1. 💾 저장 버튼 클릭 (또는 Ctrl+S / Cmd+S)
2. 스프레드시트로 돌아가서 새로고침
3. 상단 메뉴에 **📊 유틸리티 도구** 메뉴가 나타납니다
4. 처음 실행 시 권한 승인 필요:
   - 메뉴 클릭 → "권한 검토" → Google 계정 선택
   - "고급" → "안전하지 않은 페이지로 이동" 클릭
   - "허용" 클릭

## 📚 기능 목록

### 🔄 데이터 취합 및 정리
1. **여러 시트에서 데이터 취합** - 여러 시트의 특정 열/행 데이터를 하나로 통합
2. **헤더 자동 정렬 및 데이터 정리** - 헤더를 A1에 맞추고 빈 행 제거
3. **다른 스프레드시트에서 데이터 가져오기** - 외부 스프레드시트에서 데이터 임포트
4. **여러 스프레드시트 데이터 통합** - 여러 외부 스프레드시트를 한 곳에 통합
5. **모든 시트 데이터 삭제** - 모든 시트의 데이터를 한 번에 삭제
6. **Index-Match 기능** - 엑셀의 INDEX-MATCH와 유사한 검색 기능

### ⏱️ 시간 변환
3. **시간을 분으로 변환** - 9:00 → 540분
6. **분을 시간으로 변환** - 540분 → 9:00

### 🔢 숫자 포맷팅
5. **숫자를 #,##0 형식으로 변환** - 모든 숫자에 천단위 구분 쉼표 추가
8-1. **천원 단위로 표시** - 9,000,000 → 9,000천원
8-2. **천원을 원래 숫자로 변환** - 9,000천원 → 9,000,000

### ✏️ 텍스트 변환
7-1. **하이픈(-)을 언더스코어(_)로 변환**
7-2. **언더스코어(_)를 하이픈(-)으로 변환**
19. **문법 오류 교정** (현재 미구현 - 외부 API 필요)

### 📅 날짜 변환
17. **날짜 양식 통일** - 다양한 날짜 형식을 하나로 통일
18. **날짜의 년도/월 변경** - 날짜의 년도나 월을 일괄 변경

### 🗑️ 삭제 및 정리
4. **특정 열/행 삭제** - 전체 시트에서 특정 열이나 행 삭제
16. **데이터 표 자동 포맷팅** - 표를 깔끔하고 보기 좋게 포맷팅

### 🖼️ 이미지
20. **여러 이미지 일괄 업로드** (현재 미구현 - Google Drive 사용 권장)
21. **이미지를 셀에 맞게 삽입** - URL로부터 이미지를 셀에 자동 삽입

### 🖨️ 인쇄 및 내보내기
9. **데이터를 Google Docs로 이동** - 선택한 데이터를 Google Docs 테이블로 변환
10. **특정 시트 인쇄** - 선택한 시트만 PDF로 출력
11. **여러 시트 인쇄** - 여러 시트를 한 번에 PDF로 출력

## 💡 사용 방법

### 기본 사용법
1. 스프레드시트 상단의 **📊 유틸리티 도구** 메뉴 클릭
2. 원하는 카테고리 선택
3. 실행할 기능 클릭
4. 대화상자에서 필요한 정보 입력
5. 완료!

### 주요 기능별 사용 예시

#### 1. 여러 시트에서 데이터 취합
```
1. 메뉴: 데이터 취합 및 정리 > 여러 시트에서 데이터 취합
2. 취합할 시트 이름 입력 (예: Sheet1, Sheet2, Sheet3)
3. 취합할 열 번호 입력 (예: 1,3,5) 또는 전체는 빈칸
4. 취합할 행 범위 입력 (예: 2-100) 또는 전체는 빈칸
5. 새 시트에 결과 생성됨
```

#### 2. 시간/분 변환
```
1. 변환할 셀 범위 선택
2. 메뉴: 시간 변환 > 시간을 분으로 변환 (또는 그 반대)
3. 선택한 범위의 데이터가 자동 변환됨
```

#### 3. 천원 단위 변환
```
1. 변환할 숫자 셀 선택
2. 메뉴: 숫자 포맷팅 > 천원 단위로 표시
3. 9,000,000 → 9,000천원으로 변환됨
```

#### 4. 데이터 표 포맷팅
```
1. 포맷팅할 시트 활성화
2. 메뉴: 삭제 및 정리 > 데이터 표 자동 포맷팅
3. 헤더에 색상, 교대 행 색상, 테두리가 자동으로 적용됨
```

#### 5. Google Docs로 내보내기
```
1. 내보낼 데이터 범위 선택
2. 메뉴: 인쇄 및 내보내기 > 데이터를 Google Docs로 이동
3. 새 Google Docs 문서가 생성되고 URL이 표시됨
```

## ⚠️ 주의사항

### 권한 관련
- 처음 사용 시 Google 계정 권한 승인이 필요합니다
- "안전하지 않음" 경고가 나타날 수 있으나, 본인이 만든 스크립트이므로 안전합니다

### 기능 제한사항
1. **문법 교정 기능**: 외부 API(OpenAI, Google Cloud)가 필요하여 현재 미구현
2. **이미지 업로드 기능**: Google Apps Script는 로컬 파일 시스템 접근 불가
   - 대안: Google Drive에 이미지 업로드 후 사용
3. **인쇄 기능**: PDF 다운로드 링크를 제공하며, 직접 인쇄는 브라우저에서 수행

### 데이터 백업
- **특히 "모든 시트 데이터 삭제" 기능은 되돌릴 수 없습니다**
- 중요한 작업 전에는 반드시 스프레드시트 사본을 만드세요
- 파일 > 사본 만들기로 백업 생성 권장

### 성능 관련
- 대용량 데이터(10,000+ 행)를 처리할 때는 시간이 걸릴 수 있습니다
- Google Apps Script 실행 시간 제한: 6분
- 매우 큰 데이터셋의 경우 시트를 나누어 처리하세요

### 공유 스프레드시트
- 다른 사용자와 공유된 스프레드시트에서 사용할 경우
- 각 사용자가 개별적으로 스크립트 권한을 승인해야 합니다

## 🔧 문제 해결

### "권한이 없습니다" 오류
→ Apps Script 편집기에서 권한을 다시 승인하세요

### 메뉴가 나타나지 않음
→ 스프레드시트를 새로고침하세요 (F5 또는 Cmd+R)

### 기능 실행이 느림
→ 데이터량이 많을 수 있습니다. 범위를 좁히거나 나누어 실행하세요

### "스크립트 오류" 발생
→ Apps Script 편집기를 열어 오류 메시지 확인
→ 코드가 올바르게 붙여넣기 되었는지 확인

## 📞 추가 지원

이 도구는 오픈소스이며 자유롭게 수정하여 사용할 수 있습니다.

기능 추가나 수정이 필요한 경우:
1. Apps Script 편집기에서 코드 직접 수정
2. 각 함수는 명확한 주석과 함께 작성되어 있어 이해하기 쉽습니다

## 🎉 즐거운 데이터 작업 되세요!

이 도구모음으로 구글 스프레드시트 작업이 훨씬 더 효율적이 되길 바랍니다!
